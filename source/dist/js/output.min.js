!function(){"use strict";angular.module("app",["ui.router","ui.bootstrap","mwl.calendar","app.routes","app.exception"])}(),function(){"use strict";angular.module("app").controller("AbsenceController",["$scope","$modalInstance","action","event","AbsenceFactory",function(a,b,c,d,e){function f(a){var b=angular.copy(a);return"AM"===b.period.toUpperCase()?(b.starts_at=new Date(new Date(b.date).setHours(9,0,0)),b.ends_at=new Date(new Date(b.date).setHours(13,0,0))):"PM"===b.period.toUpperCase()&&(b.starts_at=new Date(new Date(b.date).setHours(13,0,0)),b.ends_at=new Date(new Date(b.date).setHours(18,0,0))),b.editable=!0,b.deletable=!0,b}function g(b){a.absence="add"===a.action?{}:angular.copy(b)}a.action=c,g(d),a.users=["Diego","Alisson","Mendonca","Diego Alisson F Mendonca"],a.today=function(){a.dt=new Date},a.today(),a.clear=function(){a.dt=null},a.disabled=function(a,b){return"day"===b&&(0===a.getDay()||6===a.getDay())},a.toggleMin=function(){a.minDate=a.minDate?null:new Date},a.toggleMin(),a.open=function(b){b.preventDefault(),b.stopPropagation(),a.opened=!0},a.dateOptions={formatYear:"yy",startingDay:0,showWeeks:!1},a.format="yyyy/MM/dd",a.submit=function(){var c=f(a.absence);switch(a.action){case"add":e.checkAvailability(c).then(function(a){a.data.length>0?alert("clash detected"):e.insertAbsence(c).then(function(a){console.log(a),b.close()})});break;case"update":e.checkAvailability(c).then(function(a){a.data.length>0&&a.data[0]._id===c._id?alert("clash detected"):e.updateAbsence(c).then(function(a){console.log(a),b.close()})});break;case"delete":e.deleteAbsence(c).then(function(a){console.log(a),b.close()})}}}])}(),function(){"use strict";angular.module("app").controller("CalendarController",["$scope","$modal","AbsenceFactory",function(a,b,c){function d(d,e){var f=b.open({templateUrl:"/source/partials/absenceModal.html",controller:"AbsenceController",size:"sm",resolve:{action:function(){return d},event:function(){return e}}});f.result.then(function(){c.getAbsences().then(function(b){a.events=b.data})},function(){})}a.events=[],c.getAbsences().then(function(b){a.events=b.data}),a.calendarView="month",a.calendarDay=new Date,a.eventClicked=function(a){d("show",a)},a.eventEdited=function(a){d("update",a)},a.eventDeleted=function(a){d("delete",a)},a.setCalendarToToday=function(){a.calendarDay=new Date},a.toggle=function(a,b,c){a.preventDefault(),a.stopPropagation(),c[b]=!c[b]},a.addAbsent=function(){d("add",{})}}])}(),function(){"use strict";angular.module("app").controller("MainController",function(){})}(),function(){"use strict";angular.module("app").controller("TestController",function(){})}(),function(){"use sctrict";angular.module("app.exception",[]).config(["$provide",function(a){a.decorator("$exceptionHandler",["$log","$delegate",function(a,b){return function(c,d){a.debug("Default exception handler."),b(c,d)}}])}])}(),function(){"use strict";angular.module("app").directive("testDirective",function(){return{restrict:"EA",templateUrl:"/source/partials/TestTemplate.html"}})}(),angular.module("app").factory("AbsenceFactory",["$http","moment",function(a,b){var c="/api/absences",d={};return d.getAbsences=function(){return a.get(c)},d.getAbsence=function(b){return a.get(c+"/"+b)},d.insertAbsence=function(b){return a.post(c,b)},d.updateAbsence=function(b){return a.put(c+"/"+b._id,b)},d.deleteAbsence=function(b){return a.delete(c+"/"+b._id)},d.checkAvailability=function(d){return a.get(c+"/filter/availability/"+b(d.date).format("YYYY,MM,DD")+"/"+d.period)},d}]),angular.module("app").factory("UserFactory",["$http",function(a){var b="/api/users",c={};return c.getUsers=function(){return a.get(b)},c.getUser=function(c){return a.get(b+"/"+c)},c.insertUser=function(c){return a.post(b,c)},c.updateUser=function(c){return a.put(b+"/"+c.ID,c)},c.deleteUser=function(c){return a.delete(b+"/"+c)},c}]),function(){"use strict";angular.module("app.routes",["ngRoute","ui.router"]).config(["$routeProvider","$stateProvider",function(a,b){a.otherwise({redirectTo:""}),b.state("main",{url:"",templateUrl:"source/partials/calendar.html",controller:"CalendarController"}).state("calendar",{url:"/calendar",templateUrl:"source/partials/calendar.html",controller:"CalendarController"}).state("map",{url:"/map",templateUrl:"source/partials/TestTemplate.html",controller:"TestController"})}])}(),function(){"use strict";angular.module("app").service("testService",function(){})}();